<?php/** "Clear" block  *  * Clear the floats vertically * Optional to use horizontal lines/images**/class AQ_Notification_Menu_Block extends AQ_Block {		//set and create block	function __construct() {		$block_options = array(			'name' => 'Notif. & Menu',			'size' => 'span12',			'icon' => 'fa-th-list',			'icon_color' => 'FFF',			'category' => 'Menu',			'help' => 'Main Menu and Logo are set here. You can choose between all the menus, that you have set in Appearance -> Menus'					);				//create the block		parent::__construct('aq_notification_menu_block', $block_options);						add_action('wp_ajax_aq_block_notification_add_new', array($this, 'add_notification'));		add_action('wp_ajax_aq_block_social_notification_add_new', array($this, 'add_social_notification'));			}		function form($instance) {				$defaults = array(							'menu' => '',		'show_menu_social' => '',			'tran_background_menu' => 0,			'notifications'		=> array(			1 => array(				'text' => 'Short content (telephone, email ...)',				'icon' => '',				'google_track' => '',				'class' => '',			)),		'social_notifications'		=> array(			1 => array(				'link' => 'Link to your social profile',				'icon' => ''			))						);						$instance = wp_parse_args($instance, $defaults);		extract($instance);		$menus = get_registered_nav_menus();					$show_menu_socials = array('Menu','Social icons','None');				if(!isset($block_id)|| $block_id == ''){ $block_id = 'aq_block_1'; }				?>		<p class="description note">			<?php _e('This block is used to display top notification (mail, telephone...) and menu.', 'pmc-themes') ?>		</p>						<div class="description cf third box">			<h3>Top left text</h3>			<ul id="aq-sortable-list-<?php echo $block_id ?>" class="aq-sortable-list" rel="<?php echo $block_id ?>" alt="notifications">				<?php				$notifications = is_array($notifications) ? $notifications : $defaults['notifications'];				$count = 1;				foreach($notifications as $notification) {						$this->notification($notification, $count);					$count++;				}				?>			</ul>			<p></p>			<a href="#" rel="notification" class="aq-sortable-add-new button">Add New</a>			<p></p>		</div>						<div class="description cf third box">			<h3>Social icons</h3>			<ul id="aq-sortable-list-<?php echo $block_id ?>" class="aq-sortable-list" rel="<?php echo $block_id ?>" alt="social_notifications">				<?php				$social_notifications = is_array($social_notifications) ? $social_notifications : $defaults['social_notifications'];				$count = 1;				foreach($social_notifications as $social_notification) {						$this->social_notification($social_notification, $count);					$count++;				}				?>			</ul>			<p></p>			<a href="#" rel="social_notification" class="aq-sortable-add-new button">Add New</a>			<p></p>		</div>				<div class="description third last box">			<h3>Other settings</h3>			<label for="<?php echo $this->get_field_id('show_menu_social') ?>" style="width:100%;float: left;margin-bottom: 10px;">			On right side display Social icons or Menu<br/>			<?php echo aq_field_select('show_menu_social', $block_id, $show_menu_socials, $show_menu_social); ?>			</label>			<label for="<?php echo $this->get_field_id('menu') ?>" style="width:100%;float: left;margin-bottom: 10px;">			Menu for this page<br/>			<?php echo aq_field_select('menu', $block_id, $menus, $menu); ?>			</label>					<label for="<?php echo $this->get_field_id('tran_background_menu') ?>" style="width:100%;float: left;margin-bottom: 10px;">				<?php echo aq_field_checkbox('tran_background_menu', $block_id, $tran_background_menu); ?>				Transparent background?			</label>					</div>							<?php			}		function social_notification($social_notification = array(), $count = 0) {			$defaults = array (			'link' => 'Link to your social profile',			'icon' => '',		);		$social_notification = wp_parse_args($social_notification, $defaults);				?>		<li id="<?php echo $this->get_field_id('social_notifications') ?>-sortable-item-<?php echo $count ?>" class="sortable-item" rel="<?php echo $count ?>" >						<div class="sortable-head cf">				<div class="sortable-title">					<strong>Social icon <?php echo $count ?></strong>					<?php if(isset($icon)) { ?>					<div class="screenshot">						<img src="<?php echo $social_notification['icon'] ?>" />					</div>					<?php } ?>									</div>				<div class="sortable-handle">					<a href="#">Open / Close</a>				</div>			</div>						<div class="sortable-body">				<p class="description">					<label for="<?php echo $this->get_field_id('social_notifications') ?>-<?php echo $count ?>-link">						Link<br/>						<input type="text" id="<?php echo $this->get_field_id('social_notifications') ?>-<?php echo $count ?>-link" class="input-full" name="<?php echo $this->get_field_name('social_notifications') ?>[<?php echo $count ?>][link]" value="<?php echo $social_notification['link'] ?>" />					</label>				</p>								<p class="teams-desc description">					<label for="<?php echo $this->get_field_id('social_notifications') ?>-<?php echo $count ?>-icon">						Social icon (<a href="https://fortawesome.github.io/Font-Awesome/icons/" target="_blank">Font Awesome add only fa-name of icon)</a><br/>						<input type="text" id="<?php echo $this->get_field_id('social_notifications') ?>-<?php echo $count ?>-icon" class="input-full" name="<?php echo $this->get_field_name('social_notifications') ?>[<?php echo $count ?>][icon]" value="<?php echo $social_notification['icon'] ?>" />					</label>				</p>									<p class="description"><a href="#" class="sortable-delete">Delete</a></p>			</div>					</li>	<?php	}			function add_social_notification() {		$nonce = $_POST['security'];			if (! wp_verify_nonce($nonce, 'aqpb-settings-page-nonce') ) die('-1');				$count = isset($_POST['count']) ? absint($_POST['count']) : false;		$this->block_id = isset($_POST['block_id']) ? $_POST['block_id'] : 'aq-block-9999';				//default key/value for the tab		$social_notification = array(			'link' => 'Link to your social profile',			'icon' => ''		);				if($count) {			$this->social_notification($social_notification, $count);		} else {			die(-1);		}				die();		}				function notification($notification = array(), $count = 0) {			$defaults = array (			'text' => 'Short content (telephone, email ...)',			'icon' => '',			'link' => '',			'google_track' => '',			'class' => '',			'user_status' => 'all',		);		$notification = wp_parse_args($notification, $defaults);				?>		<li id="<?php echo $this->get_field_id('notifications') ?>-sortable-item-<?php echo $count ?>" class="sortable-item" rel="<?php echo $count ?>">						<div class="sortable-head cf">				<div class="sortable-title">					<strong><?php echo $notification['text'] ?></strong>				</div>				<div class="sortable-handle">					<a href="#">Open / Close</a>				</div>			</div>						<div class="sortable-body">				<p class="description">					<label for="<?php echo $this->get_field_id('testimonials') ?>-<?php echo $count ?>-text">						Text<br/>						<input class="input-full" type="text" id="<?php echo $this->get_field_id('notifications') ?>-<?php echo $count ?>-text" name="<?php echo $this->get_field_name('notifications') ?>[<?php echo $count ?>][text]" value="<?php echo $notification['text'] ?>" />					</label>				</p>						<p class="description">					<label for="<?php echo $this->get_field_id('testimonials') ?>-<?php echo $count ?>-link">						Link to text<br/>						<input class="input-full" type="text" id="<?php echo $this->get_field_id('notifications') ?>-<?php echo $count ?>-link" name="<?php echo $this->get_field_name('notifications') ?>[<?php echo $count ?>][link]" value="<?php echo $notification['link'] ?>" />					</label>				</p>					<p class="description">					<label for="<?php echo $this->get_field_id('testimonials') ?>-<?php echo $count ?>-link">						Link class<br/>						<input class="input-full" type="text" id="<?php echo $this->get_field_id('notifications') ?>-<?php echo $count ?>-class" name="<?php echo $this->get_field_name('notifications') ?>[<?php echo $count ?>][class]" value="<?php echo $notification['class'] ?>" />					</label>				</p>									<p class="description">					<label for="<?php echo $this->get_field_id('testimonials') ?>-<?php echo $count ?>-google_track">						Google track (only add tracking code without "onclick")<br/>						<input class="input-full" type="text" id="<?php echo $this->get_field_id('notifications') ?>-<?php echo $count ?>-google_track" name="<?php echo $this->get_field_name('notifications') ?>[<?php echo $count ?>][google_track]" value="<?php echo $notification['google_track'] ?>" />					</label>				</p>								<p class="description"><br/>					<label for="<?php echo $this->get_field_id('notifications') ?>-<?php echo $count ?>-icon">						Icon<br/>						Awesome Text 1 Icon Class - <a href="http://fortawesome.github.io/Font-Awesome/icons/" target="_blank">refer here</a><br/>						<input type="text" id="<?php echo $this->get_field_id('notifications') ?>-<?php echo $count ?>-icon"  name="<?php echo $this->get_field_name('notifications') ?>[<?php echo $count ?>][icon]" value="<?php echo $notification['icon'] ?>" />					</label>				</p>				<p class="description"><br/>					<label for="<?php echo $this->get_field_id('notifications') ?>-<?php echo $count ?>-icon">						Icon<br/>						User status:						<input type="radio" id="<?php echo $this->get_field_id('notifications') ?>-<?php echo $count ?>-user_status"  name="<?php echo $this->get_field_name('notifications') ?>[<?php echo $count ?>][user_status]" <?php if( $notification['user_status'] == 'login') echo 'checked="checked"'; ?> value="login" /> Logged IN						<input type="radio" id="<?php echo $this->get_field_id('notifications') ?>-<?php echo $count ?>-user_status"  name="<?php echo $this->get_field_name('notifications') ?>[<?php echo $count ?>][user_status]" <?php if( $notification['user_status'] == 'logout') echo 'checked="checked"'; ?> value="logout" />	Logged Out						<input type="radio" id="<?php echo $this->get_field_id('notifications') ?>-<?php echo $count ?>-user_status"  name="<?php echo $this->get_field_name('notifications') ?>[<?php echo $count ?>][user_status]" <?php if( $notification['user_status'] == 'all') echo 'checked="all"'; ?> value="all" />	All												</label>				</p>								<p class="description"><a href="#" class="sortable-delete">Delete</a></p>			</div>					</li>	<?php	}			function add_notification() {		$nonce = $_POST['security'];			if (! wp_verify_nonce($nonce, 'aqpb-settings-page-nonce') ) die('-1');				$count = isset($_POST['count']) ? absint($_POST['count']) : false;		$this->block_id = isset($_POST['block_id']) ? $_POST['block_id'] : 'aq-block-9999';				//default key/value for the tab		$notification = array(			'text' => 'Short content (telephone, email ...)',			'icon' => '',			'link' => '',			'google_track' => '',			'class' => '',			'user_status' => 'all',		);				if($count) {			$this->notification($notification, $count);		} else {			die(-1);		}				die();		}				function block($instance) {		$defaults = array(			'menu' => '',			'show_menu_social' => 1,			'tran_background_menu' => 0,						'notifications'		=> array(				1 => array(					'text' => 'Short content (telephone, email ...)',					'icon' => '',					'link' => '',					'google_track' => '',					'class' => '',					'user_status' => 'all',				)),			'social_notifications'		=> array(				1 => array(					'link' => 'Link to your social profile',					'icon' => ''				))						);				$instance = wp_parse_args($instance, $defaults);			extract($instance);				global $pmc_data;		$tran_background_menu_class = '';		if($tran_background_menu){			$tran_background_menu_class = 'pmc_menu_transparent';		}		?>		<div class="top-nav <?php echo $tran_background_menu_class ?>">			<div class="topNotification <?php if($show_menu_social == 2) echo 'topNotification-center'; ?>">				<?php foreach($notifications as $notification) { ?>					<?php if(isset($notification['user_status'])){ ?>					<?php if(is_user_logged_in() && $notification['user_status'] == 'login' ){ ?>					<div class="topNotification-content">						<?php echo '<i class="fa '. $notification['icon'] .'"></i>' ?>						<div class="notification-text"><?php if(isset($notification['link']) && $notification['link'] != '' ){echo '<a class="'.$notification['class'].'"  href = "'.$notification['link'].'" alt="'.__($notification['text'],'pmc-themes').'">' ;}?><?php echo do_shortcode(htmlspecialchars_decode(__($notification['text'],'pmc-themes')));  ?><?php if(isset($notification['link']) && $notification['link'] != '' ){echo '</a>' ;}?></div>						</div>				<?php }					if(!is_user_logged_in() && $notification['user_status'] == 'logout'){ ?>					<div class="topNotification-content">						<?php echo '<i class="fa '. $notification['icon'] .'"></i>' ?>						<div class="notification-text"><?php if(isset($notification['link']) && $notification['link'] != '' ){echo '<a class="'.$notification['class'].'"  href = "'.$notification['link'].'" alt="'.__($notification['text'],'pmc-themes').'">' ;}?><?php echo do_shortcode(htmlspecialchars_decode(__($notification['text'],'pmc-themes')));  ?><?php if(isset($notification['link']) && $notification['link'] != '' ){echo '</a>' ;}?></div>						</div>													<?php }					if($notification['user_status'] == 'all'){ ?>					<div class="topNotification-content">						<?php echo '<i class="fa '. $notification['icon'] .'"></i>' ?>						<div class="notification-text"><?php if(isset($notification['link']) && $notification['link'] != '' ){echo '<a class="'.$notification['class'].'"  href = "'.$notification['link'].'" alt="'.__($notification['text'],'pmc-themes').'">' ;}?><?php echo do_shortcode(htmlspecialchars_decode(__($notification['text'],'pmc-themes')));  ?><?php if(isset($notification['link']) && $notification['link'] != '' ){echo '</a>' ;}?></div>						</div>													<?php }				} else { ?>						<div class="topNotification-content">						<?php echo '<i class="fa '. $notification['icon'] .'"></i>' ?>						<div class="notification-text"><?php if(isset($notification['link']) && $notification['link'] != '' ){echo '<a class="'.$notification['class'].'"  href = "'.$notification['link'].'" alt="'.__($notification['text'],'pmc-themes').'">' ;}?><?php echo do_shortcode(htmlspecialchars_decode(__($notification['text'],'pmc-themes')));  ?><?php if(isset($notification['link']) && $notification['link'] != '' ){echo '</a>' ;}?></div>						</div>					<?php }								} ?>			</div>								<?php 			if($show_menu_social != 2){				if($menu !='' && $show_menu_social == 0){					echo '<ul>';					wp_nav_menu( array('theme_location' => $menu, 'container' => 'false', 'menu_class' => 'top-nav', 'echo' => true, 'items_wrap' => '%3$s' )); 					echo '</ul>';				}								if($show_menu_social == 1){?>					<div class="social-notification">						<?php foreach($social_notifications as $social_notification) { ?>							<a target="_blank" href="<?php echo $social_notification['link'] ?>"><i class="fa <?php echo esc_attr($social_notification['icon']) ?>"></i></a>								<?php } ?>								</div>				<?php }			}			?>				</div>	<?php			}		function update($new_instance, $old_instance) {		$new_instance = aq_recursive_sanitize($new_instance);		return $new_instance;	}	}